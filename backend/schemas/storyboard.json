{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Storyboard Schema",
  "description": "JSON Schema for comic storyboard generation from novel text",
  "type": "object",
  "required": [
    "panels",
    "characters",
    "scenes"
  ],
  "properties": {
    "panels": {
      "type": "array",
      "minItems": 1,
      "description": "Array of comic panels in sequential order",
      "items": {
        "type": "object",
        "required": [
          "page",
          "index",
          "scene",
          "shotType",
          "cameraAngle",
          "background",
          "atmosphere"
        ],
        "properties": {
          "page": {
            "description": "Page number (1-based)"
          },
          "index": {
            "description": "Panel index on the page (0-5, 6 panels per page)"
          },
          "scene": {
            "type": "string",
            "minLength": 1,
            "maxLength": 800,
            "description": "Comprehensive scene description including setting, action, and mood"
          },
          "background": {
            "type": "object",
            "required": [
              "setting",
              "timeOfDay"
            ],
            "description": "Background environment details",
            "properties": {
              "sceneId": {
                "type": "string",
                "description": "Reference to scene bible entry (e.g., 'main_street', 'school_library'). Use this to maintain consistency for recurring locations."
              },
              "setting": {
                "type": "string",
                "description": "Location/environment description (e.g., '古镇石板街道', '图书馆内部', '樱花树下')"
              },
              "timeOfDay": {
                "type": "string",
                "description": "Time of day for lighting reference. Examples: dawn, morning, noon, afternoon, dusk, evening, night, midnight"
              },
              "weather": {
                "type": "string",
                "description": "Weather conditions affecting the scene. Examples: clear, cloudy, rainy, snowy, foggy, stormy, windy"
              },
              "lighting": {
                "type": "string",
                "description": "Lighting style and quality. Examples: natural, artificial, dramatic, soft, harsh, backlit, silhouette"
              },
              "details": {
                "type": "array",
                "description": "Specific background elements (e.g., '远处的山峦', '街边的灯笼', '飘落的樱花')",
                "items": {
                  "type": "string"
                }
              }
            }
          },
          "atmosphere": {
            "type": "object",
            "required": [
              "mood"
            ],
            "description": "Emotional and sensory atmosphere",
            "properties": {
              "mood": {
                "type": "string",
                "description": "Overall emotional tone of the panel. Examples: peaceful, tense, romantic, mysterious, melancholic, joyful, dramatic, calm, chaotic, nostalgic, ominous, hopeful"
              },
              "soundEffects": {
                "type": "array",
                "description": "Sound effects present in the scene",
                "items": {
                  "type": "object",
                  "required": [
                    "sound",
                    "style"
                  ],
                  "properties": {
                    "sound": {
                      "type": "string",
                      "description": "Sound description (e.g., '脚步声', '风声', '心跳')"
                    },
                    "style": {
                      "type": "string",
                      "description": "Visual prominence of the sound effect"
                    }
                  }
                }
              },
              "particleEffects": {
                "type": "array",
                "description": "Visual particle effects (e.g., '花瓣飘落', '雪花飞舞', '光尘')",
                "items": {
                  "type": "string"
                }
              }
            }
          },
          "shotType": {
            "type": "string",
            "description": "Camera shot distance/framing. Examples: close-up, medium, wide, extreme-wide, extreme-close-up, cowboy-shot"
          },
          "cameraAngle": {
            "type": "string",
            "description": "Camera angle perspective. Examples: eye-level, high-angle, low-angle, birds-eye, worms-eye, dutch-angle, over-shoulder"
          },
          "composition": {
            "type": "object",
            "description": "Visual composition and framing",
            "properties": {
              "focusPoint": {
                "type": "string",
                "description": "Main focal point of the panel (e.g., '女孩的眼睛', '两人的轮廓')"
              },
              "depthOfField": {
                "type": "string",
                "description": "Focus depth (shallow=blurred background, deep=everything sharp). Examples: shallow, deep, normal"
              },
              "rule": {
                "type": "string",
                "description": "Compositional guideline used. Examples: rule-of-thirds, golden-ratio, center-composition, diagonal, leading-lines"
              }
            }
          },
          "artStyle": {
            "type": "object",
            "description": "Visual art style specifications",
            "properties": {
              "genre": {
                "type": "string",
                "description": "Manga/art genre style. Examples: shonen, shoujo, seinen, josei, realistic, chibi, sketch"
              },
              "lineWeight": {
                "type": "string",
                "description": "Line art thickness. Examples: thin, medium, thick, varied"
              },
              "shading": {
                "type": "string",
                "description": "Shading technique. Examples: screentone, crosshatch, cel-shading, soft-shading, high-contrast"
              },
              "colorPalette": {
                "type": "string",
                "description": "Color scheme description (e.g., 'warm sunset tones', 'cool blues', 'monochrome')"
              }
            }
          },
          "characters": {
            "type": "array",
            "description": "Characters appearing in this panel",
            "items": {
              "type": "object",
              "required": [
                "name"
              ],
              "properties": {
                "name": {
                  "type": "string",
                  "minLength": 1,
                  "description": "Character name"
                },
                "pose": {
                  "type": "string",
                  "description": "Character pose/body language description"
                },
                "expression": {
                  "type": "string",
                  "description": "Character facial expression. Examples: neutral, happy, sad, angry, surprised, determined, fearful, confused, excited, shy, disgusted, contempt, anxious, loving, jealous, proud"
                },
                "position": {
                  "type": "string",
                  "description": "Character's depth position in the scene. Examples: foreground, midground, background"
                }
              }
            }
          },
          "dialogue": {
            "type": "array",
            "description": "Dialogue bubbles in this panel",
            "items": {
              "type": "object",
              "required": [
                "speaker",
                "text"
              ],
              "properties": {
                "speaker": {
                  "type": "string",
                  "description": "Name of the speaker (or 'narration' for narrative text)"
                },
                "text": {
                  "type": "string",
                  "minLength": 1,
                  "maxLength": 200,
                  "description": "Dialogue text content"
                },
                "bubbleType": {
                  "type": "string",
                  "default": "speech",
                  "description": "Type of dialogue bubble. Examples: speech, thought, narration, scream, whisper, shout"
                },
                "emotion": {
                  "type": "string",
                  "description": "Emotional tone of the dialogue. Examples: neutral, excited, angry, sad, scared, confused, joking"
                }
              }
            }
          },
          "visualPrompt": {
            "type": "string",
            "description": "Comprehensive English prompt for AI image generation (Imagen 3, Midjourney, etc.)"
          },
          "narrativeFunction": {
            "type": "string",
            "description": "Narrative purpose of this panel in storytelling. Examples: establishing-shot, action, reaction, dialogue, transition, dramatic-reveal, flashback, montage, emotional-beat"
          }
        }
      }
    },
    "characters": {
      "type": "array",
      "minItems": 1,
      "description": "Character bible - all characters appearing in the story",
      "items": {
        "type": "object",
        "required": [
          "name",
          "role"
        ],
        "properties": {
          "name": {
            "type": "string",
            "minLength": 1,
            "description": "Character name"
          },
          "role": {
            "type": "string",
            "description": "Character role in the story. Examples: protagonist, antagonist, supporting, background, mentor, love-interest"
          },
          "appearance": {
            "type": "object",
            "description": "Physical appearance description",
            "properties": {
              "gender": {
                "type": "string",
                "description": "Character gender"
              },
              "age": {
                "description": "Character age (can be number like 30 or descriptive string like 'elderly', 'young', 'middle-aged')"
              },
              "hairColor": {
                "type": "string",
                "description": "Hair color (e.g., 'black', 'blonde', 'red')"
              },
              "hairStyle": {
                "type": "string",
                "description": "Hair style (e.g., 'long', 'short', 'ponytail')"
              },
              "eyeColor": {
                "type": "string",
                "description": "Eye color"
              },
              "height": {
                "type": "string",
                "description": "Height description (e.g., 'tall', 'average', 'short')"
              },
              "build": {
                "type": "string",
                "description": "Body build (e.g., 'slim', 'athletic', 'muscular')"
              },
              "clothing": {
                "type": "array",
                "description": "Typical clothing items",
                "items": {
                  "type": "string"
                }
              },
              "distinctiveFeatures": {
                "type": "array",
                "description": "Distinctive features (e.g., 'scar on left cheek', 'glasses')",
                "items": {
                  "type": "string"
                }
              }
            }
          },
          "personality": {
            "type": "array",
            "description": "Personality traits",
            "items": {
              "type": "string"
            }
          }
        }
      }
    },
    "scenes": {
      "type": "array",
      "minItems": 1,
      "description": "Scene bible - all recurring locations/settings in the story for visual consistency",
      "items": {
        "type": "object",
        "required": [
          "id",
          "name",
          "type",
          "description"
        ],
        "properties": {
          "id": {
            "type": "string",
            "minLength": 1,
            "description": "Unique identifier for this scene (e.g., 'main_street', 'school_library', 'protagonist_home')"
          },
          "name": {
            "type": "string",
            "minLength": 1,
            "description": "Scene name (e.g., '小镇主街', '学校图书馆', '李明的家')"
          },
          "type": {
            "type": "string",
            "description": "Scene category type. Examples: indoor, outdoor, indoor-outdoor, natural, urban, rural, fantasy, abstract"
          },
          "description": {
            "type": "string",
            "minLength": 10,
            "maxLength": 500,
            "description": "Detailed description of the scene/location"
          },
          "visualCharacteristics": {
            "type": "object",
            "description": "Consistent visual elements of this scene",
            "properties": {
              "architecture": {
                "type": "string",
                "description": "Architectural style and key structures (e.g., '低矮砖房，木门窗，瓦片屋顶')"
              },
              "keyLandmarks": {
                "type": "array",
                "description": "Distinctive landmarks that define this scene",
                "items": {
                  "type": "string"
                }
              },
              "colorScheme": {
                "type": "string",
                "description": "Dominant color palette (e.g., 'warm earth tones', 'cool blues and grays')"
              },
              "lighting": {
                "type": "object",
                "description": "Typical lighting conditions",
                "properties": {
                  "naturalLight": {
                    "type": "string",
                    "description": "Amount of natural light. Examples: abundant, moderate, limited, none"
                  },
                  "artificialLight": {
                    "type": "string",
                    "description": "Artificial lighting presence. Examples: none, minimal, moderate, heavy"
                  },
                  "lightSources": {
                    "type": "array",
                    "description": "Specific light sources (e.g., '街灯', '蜡烛', '窗户')",
                    "items": {
                      "type": "string"
                    }
                  }
                }
              },
              "atmosphere": {
                "type": "string",
                "description": "General atmosphere/feeling of the scene (e.g., 'nostalgic and peaceful', 'busy and modern')"
              },
              "soundscape": {
                "type": "array",
                "description": "Typical ambient sounds in this scene",
                "items": {
                  "type": "string"
                }
              },
              "textures": {
                "type": "array",
                "description": "Dominant textures and materials (e.g., '石板地面', '木质家具', '布质窗帘')",
                "items": {
                  "type": "string"
                }
              }
            }
          },
          "spatialLayout": {
            "type": "object",
            "description": "Spatial organization of the scene",
            "properties": {
              "size": {
                "type": "string",
                "description": "Overall size/scale of the space. Examples: cramped, small, medium, large, vast"
              },
              "layout": {
                "type": "string",
                "description": "Spatial arrangement description (e.g., '狭长的街道，两旁是店铺')"
              },
              "keyAreas": {
                "type": "array",
                "description": "Important sub-areas within the scene",
                "items": {
                  "type": "object",
                  "properties": {
                    "name": {
                      "type": "string",
                      "description": "Sub-area name"
                    },
                    "description": {
                      "type": "string",
                      "description": "Sub-area description"
                    }
                  }
                }
              }
            }
          },
          "timeVariations": {
            "type": "array",
            "description": "How this scene appears at different times",
            "items": {
              "type": "object",
              "required": [
                "timeOfDay",
                "description"
              ],
              "properties": {
                "timeOfDay": {
                  "type": "string"
                },
                "description": {
                  "type": "string",
                  "description": "How the scene looks/feels at this time"
                },
                "lightingChanges": {
                  "type": "string",
                  "description": "Specific lighting changes"
                }
              }
            }
          },
          "weatherVariations": {
            "type": "array",
            "description": "How this scene appears in different weather",
            "items": {
              "type": "object",
              "required": [
                "weather",
                "description"
              ],
              "properties": {
                "weather": {
                  "type": "string"
                },
                "description": {
                  "type": "string",
                  "description": "How weather affects the scene's appearance"
                }
              }
            }
          },
          "narrativeRole": {
            "type": "string",
            "description": "This scene's role in the narrative. Examples: primary-setting, secondary-setting, transitional, symbolic, flashback-location, dream-sequence"
          },
          "firstAppearance": {
            "type": "object",
            "description": "When this scene first appears in the story",
            "properties": {
              "chapter": {
                "description": "Chapter number"
              },
              "page": {
                "description": "Page number"
              },
              "panelIndex": {
                "description": "Panel index"
              }
            }
          },
          "referenceImages": {
            "type": "array",
            "description": "Reference image URLs or descriptions for consistency",
            "items": {
              "type": "string"
            }
          }
        }
      }
    },
    "totalPages": {
      "description": "Total number of pages in the storyboard"
    }
  }
}